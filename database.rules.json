{
  "rules": {
    ".read": true,
    ".write": true,
    "tenants": {
      "$tenantId": {
        ".read": "auth != null && auth.token.tenantId == $tenantId",
        ".write": "auth != null && auth.token.tenantId == $tenantId",

      
        "settings": {
          ".read": "true",
          ".write": "auth != null && auth.token.tenantId == $tenantId"
        },

        "secure_links": {
          "$linkId": {
            ".read": "true",
            ".write": "(auth != null && auth.token.tenantId == $tenantId) || (data.exists() && newData.exists() && newData.child('id').val() == data.child('id').val() && newData.child('created').val() == data.child('created').val() && newData.child('expiration').val() == data.child('expiration').val() && newData.child('maxUsage').val() == data.child('maxUsage').val() && newData.child('expirationHours').val() == data.child('expirationHours').val() && newData.child('customCode').val() == data.child('customCode').val() && newData.child('hash').val() == data.child('hash').val() && newData.child('usedCount').isNumber() && newData.child('usedCount').val() >= data.child('usedCount').val() && newData.child('usedCount').val() <= data.child('maxUsage').val() && ((data.child('status').val() == 'active' && (newData.child('status').val() == 'active' || newData.child('status').val() == 'used')) || (data.child('status').val() == 'used' && newData.child('status').val() == 'used')))"
          }
        },

       
        "devices": {
          ".read": false,
          ".write": false
        }
      }
    }
  }
}
